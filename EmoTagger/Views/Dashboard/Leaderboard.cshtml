@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container py-4">
    <h2 class="text-danger mb-4">🎶 Türkçe Hit Albüm (YouTube Playlist)</h2>

    <!-- YouTube Player Alanı -->
    <div id="youtubePlayerArea" style="display:none;" class="mb-4">
        <h5 id="currentPlayingTitle" class="text-primary mb-2"></h5>
        <iframe id="youtubePlayerFrame" width="100%" height="360" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>

    <div id="youtubeHits" class="row row-cols-1 row-cols-md-3 g-4"></div>
</div>

@section Scripts {
    <script>
        const apiKey = 'AIzaSyBkFtoa5XHfSKzUdkU6LwED3-I_UHM_YQE'; // Buraya kendi YouTube API anahtarını yaz
        const playlistId = 'PLDIoUOhQQPlVr3qepMVRsDe4T8vNQsvno'; // Ornek playlist

        async function loadYoutubeHits() {
            const url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=15&playlistId=${playlistId}&key=${apiKey}`;
            const res = await fetch(url);
            const data = await res.json();
            const container = document.getElementById("youtubeHits");

            data.items.forEach(item => {
                const videoId = item.snippet.resourceId.videoId;
                const title = item.snippet.title;
                const thumbnail = item.snippet.thumbnails.medium.url;

                const card = `
                    <div class="col">
                        <div class="card music-card shadow-sm" onclick="playYoutubeTrack('${videoId}', '${title.replace(/'/g, "\'")}')">
                            <img src="${thumbnail}" class="card-img-top" alt="${title}">
                            <div class="card-body">
                                <h5 class="card-title">${title}</h5>
                                <button class="btn btn-outline-danger w-100">🎵 Dinle</button>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += card;
            });
        }

        function playYoutubeTrack(videoId, title) {
            const playerArea = document.getElementById("youtubePlayerArea");
            const iframe = document.getElementById("youtubePlayerFrame");
            const titleText = document.getElementById("currentPlayingTitle");

            titleText.textContent = `Şu An Çalıyor: ${title}`;
            iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
            playerArea.style.display = "block";
        }

        document.addEventListener('DOMContentLoaded', loadYoutubeHits);
    </script>

    <style>
        .music-card {
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

            .music-card:hover {
                transform: scale(1.03);
                box-shadow: 0 0 10px rgba(255, 0, 0, 0.4);
            }
    </style>
}
